# Development environment (short)

Use Docker Compose + Make for a one-command local stack.

## Prereqs

- Docker Desktop
- Git
- Make
- Python 3.11 (when running outside Docker)

## Setup

```bash
git clone https://github.com/your-org/chatbot-api-service.git
cd chatbot-api-service
cp .env.example .env   # fill in keys you need
make up
make ingest
curl http://localhost:8000/health
```

## Useful commands

```bash
make up         # start
make down       # stop
make logs       # follow logs
make test       # run tests
make lint       # ruff
make format     # ruff format
make db-shell   # psql
make db-status  # pgvector status
```

## Env basics

Put secrets in `.env`:

```env
OPENROUTER_API_KEY=...
GROQ_API_KEY=...
OPENAI_API_KEY=...
REDIS_AUTH=change-me
# Optional: Langfuse
LANGFUSE_PUBLIC_KEY=...
LANGFUSE_SECRET_KEY=...
LANGFUSE_HOST=http://langfuse:3000
```

If you enable Langfuse v3, also set `LANGFUSE_S3_EVENT_UPLOAD_*` variables (see `docs/7.0-clickhouse-langfuse-setup.md`).

CORS: in dev, leave `CORS_ALLOW_ORIGINS` empty; in prod, set explicit origins.

## Services

- FastAPI (8000), PostgreSQL+pgvector, Redis, optional Langfuse+ClickHouse+MinIO.
- Metrics: `http://localhost:8000/metrics` (Prometheus format) if enabled.

## Troubleshooting

- Langfuse startup errors → missing S3 vars. See `docs/7.0-clickhouse-langfuse-setup.md`.
- Redis auth → ensure `REDIS_AUTH` matches Compose.
- pgvector → `make db-status`, ensure `vector` extension is present.
